Attach("compute_corrections.m");
Attach("count_plane_model.m");
import "compute_zeta_function.m": OptimisedComputeZetaFunctionNumerator;

SetGPU(true);

SetVerbose("Kyng",2);


p_1 := 19;
R<x,y> := PolynomialRing(GF(p_1), 2);
f_1 := x^36 + 6*x^35 + 15*x^34 + x^33 + 15*x^32 + 12*x^31 + 6*x^30*y + 5*x^30 + 11*x^29*y + 6*x^29 + 3*x^28*y + 9*x^28 + 3*x^27*y + 17*x^27 + 11*x^26*y + 5*x^26 + 17*x^25*y + 18*x^25 + 15*x^24*y^2 + 9*x^24*y + 10*x^24 + 3*x^23*y^2 + 2*x^23*y + 14*x^23 + 14*x^22*y^2 + 5*x^22*y + 7*x^22 + 3*x^21*y^2 + 4*x^21*y + 16*x^21 + 15*x^20*y^2 + 6*x^20*y + 12*x^20 + 3*x^19*y^2
    + 2*x^19*y + 14*x^19 + x^18*y^3 + 15*x^18*y^2 + 6*x^18 + 3*x^17*y^3 + 8*x^17*y^2 + 18*x^17*y + 9*x^17 + 3*x^16*y^3 + 2*x^16*y^2 + 10*x^16*y + 13*x^16 + x^15*y^3 + 6*x^15*y^2 + 15*x^15*y + 17*x^15 + 14*x^14*y^2 + 5*x^14*y + 18*x^14 + 3*x^13*y^3 + 8*x^13*y^2 + 18*x^13*y + 9*x^13 + 15*x^12*y^4 + 12*x^12*y^3 + 11*x^12*y^2 + 2*x^12 + 11*x^11*y^4 + 15*x^11*y^3
    + 16*x^11*y^2 + 8*x^11*y + 5*x^11 + 15*x^10*y^4 + 6*x^10*y^3 + 18*x^10*y^2 + 8*x^10*y + 6*x^10 + 3*x^9*y^2 + 7*x^9*y + 13*x^9 + 3*x^8*y^3 + 2*x^8*y^2 + 10*x^8*y + 17*x^8 + 11*x^7*y^4 + 15*x^7*y^3 + 16*x^7*y^2 + 8*x^7*y + 7*x^7 + 6*x^6*y^5 + 14*x^6*y^4 + 5*x^6*y^3 + 3*x^6*y^2 + 12*x^6*y + 11*x^6 + 6*x^5*y^5 + 3*x^5*y^4 + 12*x^5*y^3 + 5*x^5*y^2 + 12*x^5*y 
    + 8*x^5 + 7*x^4*y^2 + x^4*y + 12*x^4 + x^3*y^3 + 6*x^3*y^2 + 12*x^3*y + 8*x^3 + 15*x^2*y^4 + 6*x^2*y^3 + 18*x^2*y^2 + 5*x^2*y + 12*x^2 + 6*x*y^5 + 3*x*y^4 + 12*x*y^3 + 5*x*y^2 + 5*x*y + 2*x + y^6 + 12*y^5 + 3*y^4 + 8*y^3 + 12*y^2 + 2*y + 7;

res, t_1, t_2, t_3, t_4, mem := OptimisedComputeZetaFunctionNumerator(f_1);
print t_1, t_2, t_3, t_4, mem, "\n";
print res;

p_2 := 23;
R<x,y> := PolynomialRing(GF(p_2), 2);
f_2 := 2*x^30 + 3*x^26 + 3*x^25*y + 6*x^25 + 22*x^22 + 21*x^21*y + 8*x^21 + 22*x^20*y^2
    + 19*x^20*y + 19*x^20 + 13*x^18 + 22*x^17*y + 16*x^17 + 22*x^16*y^2 + 
    9*x^16*y + x^16 + 15*x^15*y^3 + 21*x^15*y^2 + 19*x^15*y + 6*x^15 + 20*x^14 +
    8*x^13 + 14*x^12*y^2 + 17*x^12*y + 19*x^12 + 17*x^11*y^3 + 21*x^11*y^2 + 
    12*x^11*y + 10*x^10*y^4 + 11*x^10*y^3 + 10*x^10*y^2 + 12*x^10*y + x^10 + 
    16*x^9*y + 22*x^9 + 22*x^8*y^2 + 22*x^8*y + 11*x^8 + 10*x^7*y^3 + 17*x^7*y^2
    + 7*x^7*y + 13*x^7 + 5*x^6*y^4 + 5*x^6*y^3 + 13*x^6*y^2 + 19*x^6*y + x^5*y^5
    + 10*x^5*y^4 + 17*x^5*y^3 + 13*x^5*y^2 + 14*x^5*y + 5*x^5 + 20*x^4*y^2 + 
    8*x^4*y + 18*x^4 + 19*x^3*y^3 + 5*x^3*y^2 + 16*x^3*y + 8*x^3 + 15*x^2*y^4 + 
    2*x^2*y^3 + 2*x^2*y^2 + 4*x^2*y + 14*x^2 + 6*x*y^5 + 4*x*y^4 + 11*x*y^2 + 
    22*x*y + 13*x + y^6 + 12*y^5 + 14*y^4 + 22*y^3 + 10*y^2 + 8*y + 18;

res, t_1, t_2, t_3, t_4, mem := OptimisedComputeZetaFunctionNumerator(f_2);
print t_1, t_2, t_3, t_4, mem, "\n";
print res;


p_3 := 31;
R<x,y> := PolynomialRing(GF(p_3), 2);
f_3 := x^36 + 6*x^35 + 15*x^34 + 26*x^33 + 12*x^32 + 6*x^31 + 6*x^30*y + 16*x^30 + 30*x^29*y + 21*x^29 + 29*x^28*y + 13*x^28 + 28*x^27*y + 24*x^27 + 16*x^26*y + 7*x^26 + 20*x^25*y + 26*x^25 + 15*x^24*y^2 + 15*x^24*y + 18*x^24 + 29*x^23*y^2 + 9*x^23*y + 25*x^23 + 28*x^22*y^2 + 27*x^22*y + 14*x^22 + 27*x^21*y^2 + 6*x^21*y + 28*x^21 + 20*x^20*y^2 + 21*x^20*y + 27*x^20
    + 23*x^19*y^2 + x^19*y + 12*x^19 + 20*x^18*y^3 + 8*x^18*y^2 + x^18*y + 22*x^18 + 29*x^17*y^3 + 2*x^17*y^2 + 9*x^17*y + 28*x^17 + 29*x^16*y^3 + 2*x^16*y^2 + 23*x^16*y + 8*x^16 + 18*x^15*y^3 + 30*x^15*y^2 + 6*x^15*y + 28*x^15 + 7*x^14*y^3 + 16*x^14*y^2 + 20*x^14*y + 14*x^14 + 16*x^13*y^3 + 27*x^13*y^2 + 26*x^13*y + 26*x^13 + 15*x^12*y^4 + 24*x^12*y^3 + 
    29*x^12*y^2 + 3*x^12*y + 9*x^12 + 30*x^11*y^4 + 22*x^11*y^2 + 3*x^11*y + 5*x^11 + 15*x^10*y^4 + 23*x^10*y^3 + 13*x^10*y^2 + 15*x^10*y + 12*x^10 + 30*x^9*y^4 + 26*x^9*y^3 + 16*x^9*y^2 + 11*x^9*y + 28*x^9 + 20*x^8*y^4 + 26*x^8*y^3 + 7*x^8*y^2 + 10*x^8*y + 27*x^8 + 19*x^7*y^4 + 30*x^7*y^3 + 21*x^7*y + 12*x^7 + 6*x^6*y^5 + 9*x^6*y^4 + 8*x^6*y^3 + 27*x^6*y^2 
    + x^6*y + 25*x^6 + 6*x^5*y^5 + 17*x^5*y^4 + 20*x^5*y^3 + 25*x^5*y^2 + x^5*y + 19*x^5 + 10*x^4*y^4 + 18*x^4*y^3 + 13*x^4*y^2 + 22*x^4*y + 22*x^4 + 6*x^3*y^5 + 7*x^3*y^4 + 25*x^3*y^3 + 27*x^3*y^2 + 10*x^3*y + 11*x^3 + 29*x^2*y^5 + 20*x^2*y^4 + 20*x^2*y^3 + 16*x^2*y^2 + 28*x^2*y + 13*x^2 + 12*x*y^5 + 23*x*y^4 + 29*x*y^3 + 23*x*y^2 + 15*x*y + 12*x + y^6 + 
    24*y^5 + 23*y^4 + 9*y^3 + 27*y^2 + 6*y + 4;

res, t_1, t_2, t_3, t_4, mem := OptimisedComputeZetaFunctionNumerator(f_3);
print t_1, t_2, t_3, t_4, mem, "\n";
print res;

p_4 := 19;
R<x,y> := PolynomialRing(GF(p_4), 2);
f_4 := 2*x^28 + 11*x^24*y + 14*x^24 + 11*x^20*y^2 + 9*x^20*y + 4*x^20 + 4*x^16*y^3 + 17*x^16*y^2 + 13*x^16*y + 13*x^16 + 8*x^13 + 14*x^12*y^4 + 16*x^12*y^3 + 15*x^12*y^2 + 11*x^12*y + 13*x^12 + 6*x^10 + 
    3*x^9*y + 18*x^9 + 18*x^8*y^5 + 4*x^8*y^4 + 5*x^8*y^3 + 15*x^8*y^2 + 13*x^8*y + 4*x^8 + 6*x^7 + 5*x^6*y + x^6 + 12*x^5*y^2 + 13*x^5*y + 5*x^5 + 2*x^4*y^6 + 17*x^4*y^5 + 4*x^4*y^4 + 16*x^4*y^3 + 
    17*x^4*y^2 + 9*x^4*y + 14*x^4 + 3*x^3*y + 9*x^3 + x^2*y^2 + 18*x^2*y + 7*x^2 + 11*x*y^3 + 15*x*y^2 + x*y + 13*x + y^7 + 2*y^6 + 18*y^5 + 14*y^4 + 4*y^3 + 11*y^2 + 11*y + 2;

res, t_1, t_2, t_3, t_4, mem := OptimisedComputeZetaFunctionNumerator(f_4);
print t_1, t_2, t_3, t_4, mem, "\n";
print res;

p_5 := 29;
R<x,y> := PolynomialRing(GF(p_5), 2);
f_5 := 12*x^28 + 28*x^24*y + 26*x^24 + 28*x^20*y^2 + 23*x^20*y + 20*x^20 + 22*x^16*y^3 
    + 24*x^16*y^2 + 14*x^16*y + 14*x^16 + 15*x^13 + 17*x^12*y^4 + x^12*y^3 + 
    19*x^12*y^2 + 9*x^12*y + 14*x^12 + 2*x^10 + 3*x^9*y + 14*x^9 + 15*x^8*y^5 + 
    22*x^8*y^4 + 16*x^8*y^3 + 19*x^8*y^2 + 14*x^8*y + 20*x^8 + 10*x^7 + 21*x^6*y
    + 25*x^6 + 26*x^5*y^2 + 20*x^5*y + 6*x^5 + 21*x^4*y^6 + x^4*y^5 + 22*x^4*y^4
    + x^4*y^3 + 24*x^4*y^2 + 23*x^4*y + 26*x^4 + 5*x^3*y + 15*x^3 + 10*x^2*y^2 +
    12*x^2*y + 4*x^2 + 25*x*y^3 + 18*x*y^2 + 16*x*y + 10*x + y^7 + 21*y^6 + 
    15*y^5 + 17*y^4 + 22*y^3 + 28*y^2 + 28*y + 12;

res, t_1, t_2, t_3, t_4, mem := OptimisedComputeZetaFunctionNumerator(f_5);
print t_1, t_2, t_3, t_4, mem, "\n";
print res;

p_6 := 13;
R<x,y> := PolynomialRing(GF(p_6), 2);
f_6 := 9*x^32 + 10*x^31 + 8*x^30 + 4*x^29 + 10*x^28*y + 10*x^28 + 9*x^27*y + 3*x^27 + 3*x^26*y + 9*x^26 + 5*x^25*y + 2*x^25 + 11*x^24*y^2 + 2*x^24*y + 11*x^24 + 7*x^23*y^2 + 11*x^23*y + 6*x^23 + 6*x^22*y^2 + 11*x^22*y + 11*x^22 + 4*x^21*y + 4*x^21 + 11*x^20*y^3 + 12*x^20*y^2 + 3*x^20*y + 2*x^20 + 8*x^19*y^3 + 4*x^19*y + 2*x^19 + 3*x^18*y^3 + 4*x^18*y^2 + 8*x^18*y +
    7*x^18 + 2*x^17*y^3 + 12*x^17*y^2 + 11*x^17*y + 10*x^17 + 2*x^16*y^4 + x^16*y^3 + 8*x^16*y^2 + x^16 + 4*x^15*y^4 + 2*x^15*y^3 + 8*x^15*y^2 + x^15*y + 2*x^15 + 7*x^14*y^4 + 5*x^14*y^3 + 9*x^14*y^2 + x^14*y + 6*x^14 + 11*x^13*y^4 + 6*x^13*y^3 + 11*x^13*y^2 + x^13 + 6*x^12*y^5 + 12*x^12*y^4 + 7*x^12*y^3 + 4*x^12*y^2 + 6*x^12*y + 7*x^12 + 9*x^11*y^5 + 
    5*x^11*y^4 + 10*x^11*y^3 + 11*x^11*y^2 + x^11*y + 2*x^11 + 7*x^10*y^5 + 12*x^10*y^3 + 9*x^10*y^2 + 3*x^10*y + 7*x^10 + 9*x^9*y^5 + 7*x^9*y^4 + 10*x^9*y^3 + 11*x^9*y^2 + 4*x^9*y + x^9 + 8*x^8*y^6 + 11*x^8*y^5 + x^8*y^4 + 7*x^8*y^3 + 5*x^8*y^2 + 8*x^7*y^6 + 12*x^7*y^5 + 7*x^7*y^4 + 6*x^7*y^3 + 10*x^7*y^2 + x^7*y + 8*x^7 + 10*x^6*y^6 + 3*x^6*y^5 + 5*x^6*y^3
    + 7*x^6*y + 3*x^6 + 12*x^5*y^6 + 12*x^5*y^5 + 5*x^5*y^4 + x^5*y^3 + 2*x^5*y^2 + 6*x^5*y + 2*x^5 + 3*x^4*y^7 + 9*x^4*y^6 + 11*x^4*y^5 + 12*x^4*y^4 + 6*x^4*y^3 + 6*x^4*y + 5*x^4 + 8*x^3*y^7 + 12*x^3*y^6 + 9*x^3*y^5 + 11*x^3*y^4 + 7*x^3*y^3 + 2*x^3*y^2 + 4*x^3*y + x^3 + 8*x^2*y^7 + 10*x^2*y^6 + 7*x^2*y^5 + 7*x^2*y^4 + 10*x^2*y^3 + 10*x^2*y^2 + 12*x^2*y + 
    x^2 + 8*x*y^7 + 8*x*y^6 + 9*x*y^5 + 2*x*y^4 + 10*x*y^3 + 8*x*y^2 + 3*x*y + 3*x + y^8 + 3*y^7 + 8*y^6 + 6*y^5 + 2*y^4 + 11*y^3 + 11*y^2 + 10*y + 9;

res, t_1, t_2, t_3, t_4, mem := OptimisedComputeZetaFunctionNumerator(f_6);
print t_1, t_2, t_3, t_4, mem, "\n";
print res;

p_7 := 17;
R<x,y> := PolynomialRing(GF(p_7), 2);
f_7 := x^32 + 4*x^31 + 11*x^30 + 8*x^29 + 4*x^28*y + x^28 + 14*x^27*y + 11*x^27 + x^26*y + 11*x^26 + 14*x^25*y + 14*x^25 + 7*x^24*y^2 + 9*x^24*y + 8*x^24 + 4*x^23*y^2 + 11*x^23*y + 8*x^23 + 9*x^22*y^2 + 10*x^22 + 6*x^21*y^2 + 8*x^21*y + 15*x^21 + 7*x^20*y^3 + 9*x^20*y + 2*x^20 + 9*x^19*y^3 + 10*x^19*y^2 + 7*x^19*y + 5*x^19 + x^18*y^3 + 4*x^18*y^2 + 11*x^18*y + 
    2*x^18 + 6*x^17*y^3 + 15*x^17*y^2 + 9*x^17*y + 12*x^17 + 15*x^16*y^4 + 7*x^16*y^3 + 14*x^16*y^2 + 15*x^16*y + 12*x^16 + 13*x^15*y^4 + 15*x^15*y^3 + 2*x^15*y^2 + 9*x^15*y + 4*x^15 + 10*x^14*y^4 + 14*x^14*y^3 + 2*x^14*y^2 + 9*x^14*y + 14*x^14 + 6*x^13*y^4 + 5*x^13*y^3 + 14*x^13*y^2 + x^13*y + 3*x^13 + 6*x^12*y^5 + 12*x^12*y^4 + 12*x^12*y^3 + 9*x^12*y^2 + 
    16*x^12*y + 7*x^12 + 9*x^11*y^5 + 12*x^11*y^4 + 15*x^11*y^3 + 13*x^11*y^2 + 15*x^11*y + 6*x^11 + 5*x^10*y^5 + 16*x^10*y^3 + 16*x^10*y^2 + 11*x^10 + 6*x^9*y^5 + 14*x^9*y^4 + 2*x^9*y^3 + 14*x^9*y + 11*x^9 + 10*x^8*y^6 + 13*x^8*y^5 + 2*x^8*y^4 + 7*x^8*y + 3*x^8 + 10*x^7*y^6 + 15*x^7*y^5 + 11*x^7*y^4 + 7*x^7*y^3 + 3*x^7*y^2 + 12*x^7*y + x^7 + 4*x^6*y^6 + 
    x^6*y^5 + 5*x^6*y^4 + 13*x^6*y^3 + x^6*y^2 + 7*x^6 + 15*x^5*y^6 + 11*x^5*y^5 + x^5*y^4 + 4*x^5*y^3 + 4*x^5*y^2 + 6*x^5*y + 16*x^4*y^7 + 12*x^4*y^6 + 12*x^4*y^5 + 14*x^4*y^4 + 5*x^4*y^3 + 10*x^4*y^2 + 4*x^4*y + x^4 + 8*x^3*y^7 + 3*x^3*y^6 + 9*x^3*y^5 + 14*x^3*y^4 + 7*x^3*y^3 + 14*x^3*y^2 + 8*x^3*y + 10*x^3 + 8*x^2*y^7 + 9*x^2*y^6 + 10*x^2*y^5 + x^2*y^4 + 
    7*x^2*y^3 + 11*x^2*y^2 + 6*x^2*y + 13*x^2 + 8*x*y^7 + 15*x*y^6 + 16*x*y^5 + 12*x*y^4 + 2*x*y^3 + 7*x*y^2 + 7*x*y + 3*x + y^8 + 7*y^7 + 14*y^6 + 16*y^5 + 9*y^4 + 8*y^3 + 12*y^2 + 3*y + 16;

res, t_1, t_2, t_3, t_4, mem := OptimisedComputeZetaFunctionNumerator(f_7);
print t_1, t_2, t_3, t_4, mem, "\n";
print res;